<mat-card class="post">
  <mat-card-header *ngIf="postContext === postContexts.PostsPage || postContext === postContexts.PostPage">
    <div mat-card-avatar class="post-header-image">
      <a [routerLink]="[userProfileRoute, post.authorId]">
        <img [src]="post.authorAvatar  || './assets/images/common/no_avatar.jpg'" alt="{{ post.authorUsername }}'s avatar">
      </a>
    </div>
    <mat-card-title>
      <a [routerLink]="[userProfileRoute, post.authorId]">
        {{ post.authorUsername }}
      </a>
      <span class="role role-red" *ngIf="post.userRole">{{ post.userRole | titlecase }}</span>
    </mat-card-title>
    <mat-card-subtitle>
      <a class="category" (click)="navigate()">{{ post.category }}</a> ·
      <span [matTooltip]="post.tooltipDate">{{ post.date | timeAgo }}</span>
    </mat-card-subtitle>
  </mat-card-header>

  <mat-card-subtitle *ngIf="postContext === postContexts.ProfilePage">
    <span>{{ post.category }}</span> ·
    <span [matTooltip]="post.tooltipDate">{{ post.date | timeAgo }}</span> ·
    <span>{{ post.userActionOnPost }}</span>
  </mat-card-subtitle>


  <mat-card-content>
    <markdown [data]="post.content" ngPreserveWhitespaces></markdown>
  </mat-card-content>

  <mat-card-actions>
    <a mat-button [routerLink]="[postRoute[postContext], post.id]" *ngIf="postContext === postContexts.PostsPage || postContext ===  postContexts.ProfilePage" (click)="onPostLink()">
      <mat-icon>comment</mat-icon>
    </a>

    <button mat-button [matMenuTriggerFor]="menuActions">
      <mat-icon>more_horiz</mat-icon>
    </button>

    <mat-menu #menuActions="matMenu">
      <button mat-menu-item (click)="onCopyLink()">
        <mat-icon>content_copy</mat-icon>
        <span class="menu-item-name">Copy link</span>
      </button>

      <button mat-menu-item (click)="onEdit()" *ngIf="canEditOrDelete && postContext === postContexts.PostPage">
        <mat-icon>edit</mat-icon>
        <span class="menu-item-name">Edit</span>
      </button>

      <button mat-menu-item (click)="onDelete()" *ngIf="canEditOrDelete">
        <mat-icon>delete</mat-icon>
        <span class="menu-item-name">Delete</span>
      </button>
    </mat-menu>
  </mat-card-actions>
</mat-card>
